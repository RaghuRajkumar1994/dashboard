<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Team Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <div class="dashboard-container">
        
        <header class="dashboard-header">
            <div class="header-logo">
                <select id="theme-selector" class="theme-selector">
                    <option value="default">Default Theme</option>
                    <option value="green">Green Theme</option>
                    <option value="blue">Blue Theme</option>
                    <option value="purple">Purple Theme</option>
                    <option value="red">Red Theme</option>
                    <option value="orange">Orange Theme</option>
                    <option value="cyan">Cyan Theme</option>
                    <option value="mono">Monochrome</option>
                </select>
                <input type="month" id="month-selector" class="header-date">
            </div>
            <h1 class="header-title">PRODUCTION TEAM DASHBOARD</h1>
            <div class="header-controls">
                <button class="control-btn" id="open-update-btn">UPDATE</button>
                <input type="file" id="excelFileInput" accept=".xlsx, .xls, .json" style="display: none;">
                <input type="file" id="trendFileInput" accept=".json" style="display: none;"> 
            </div>
        </header>

        <main class="dashboard-main">
            <section class="top-row-panels">
                <div class="panel machine-output">
                    <div class="panel-header">MACHINE TOTAL OUTPUT</div>
                    <div class="output-list">
                        <div class="output-item auto-crimp"><span>AUTO CRIMP</span><span id="auto-crimp-output">4243483</span></div>
                        <div class="output-item semi-crimp"><span>SEMI CRIMP</span><span id="semi-crimp-output">1663872</span></div>
                        <div class="output-item soldering"><span>SOLDERING</span><span id="soldering-output">378998</span></div>
                    </div>
                </div>
                
                <div class="panel cut-qty">
                    <div class="panel-header">CUT'S HOUR QTY</div>
                    <div class="cut-qty-grid">
                        <div class="shifts-container">
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-A</div><div class="shift-value" id="shift-a-value">2298</div>
                            </div>
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-B</div><div class="shift-value" id="shift-b-value">2092</div>
                            </div>
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-C</div><div class="shift-value" id="shift-c-value">2052</div>
                            </div>
                        </div>
                        <div class="average-box">
                            <span class="average-label">AVERAGE</span><span class="average-value" id="cuts-average-value">2179</span>
                        </div>
                    </div>
                </div>

                <div class="panel breakdown-time">
                    <div class="panel-header">BREAKDOWN TIME</div>
                    <div class="breakdown-grid-container">
                        <div class="breakdown-section msf-section">
                            <div class="col-label">MSF</div>
                            <div class="breakdown-data-item"><span>PLANT-2</span><span class="data-value" id="msf-plant-2">8.05</span></div>
                            <div class="breakdown-data-item"><span>PLANT-7</span><span class="data-value" id="msf-plant-7">10.10</span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P2</span><span class="data-value" id="m-total-msf-p2">118</span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P7</span><span class="data-value" id="m-total-msf-p7">118</span></div>
                        </div>
                        <div class="breakdown-section assembly-section">
                            <div class="col-label">ASSEMBLY</div>
                            <div class="breakdown-data-item"><span>PLANT-2</span><span class="data-value" id="assembly-plant-2">171</span></div>
                            <div class="breakdown-data-item"><span>PLANT-7</span><span class="data-value" id="assembly-plant-7">71</span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P2</span><span class="data-value" id="m-total-assembly-p2">1516</span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P7</span><span class="data-value" id="m-total-assembly-p7">1516</span></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="panel production-trend-panel">
                <div class="panel-header">PRODUCTION TREND <button class="update-trend-btn" id="open-trend-update-btn">UPDATE TREND</button></div>
                <div class="table-container">
                    <table id="production-trend-table">
                        <thead>
                            <tr>
                                <th class="trend-header-cell">CUSTOMER NAME</th>
                                <th class="trend-header-cell">OVERALL OUTPUT</th>
                                <th class="trend-header-cell">%</th>
                                <th class="trend-header-cell">CUSTOMER NAME</th>
                                <th class="trend-header-cell">OVERALL OUTPUT</th>
                                <th class="trend-header-cell">%</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="panel shortcut-panel">
                <div class="panel-header">DATA EXCEL SHORTCUT</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\BreakdownSheet.xlsx">BREAKDOWN SHEET</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\Plant2Data.xlsx">PLANT 2</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\Plant7Data.xlsx">PLANT 7</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\CutsHourQty.xlsx">CUT'S HOUR QTY</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\DRM.xlsx">DRM</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\ProductionAct.xlsx">PRODUCTION ACT</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\SFTProductionReport.xlsx">SFT PRODUCTION REPORT</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\StockLiveData.xlsx">STOCK LIVE DATA</div>
                <div class="shortcut-item" data-link="\\192.168.4.6\CCS Lab\raghu\MSFPrintoutSheets.xlsx">MSF PRINTOUT SHEETS</div>
            </div>

            <div class="panel productivity-panel">
                <div class="panel-header">PRODUCTIVITY</div>
                <div class="chart-container">
                    <div class="chart-circle productivity-chart" style="background: conic-gradient(#50fa7b 75%, transparent 0);">
                        <span class="chart-value" id="productivity-value">75%</span>
                    </div>
                </div>
            </div>

            <div class="panel schedule-panel">
                <div class="panel-header">SCHEDULE AVERAGE</div>
                <div class="chart-container">
                    <div class="chart-circle schedule-chart" style="background: conic-gradient(#ff79c6 56%, transparent 0);">
                        <span class="chart-value" id="schedule-value">56%</span>
                    </div>
                </div>
            </div>

            <div class="panel lv-production-panel">
                <div class="panel-header">LV-PRODUCTION VALUE</div>
                <div class="value-box">₹ <span id="lv-production-value">10,797,661</span></div>
            </div>

            <div class="panel notifications-panel">
                <div class="panel-header">NOTIFICATIONS</div>
                <div class="icon-group">
                    <div class="icon-box" data-modal="user-list-modal">USERS</div>
                    <div class="icon-box" id="openMail">MAIL'S</div>
                    <div class="icon-box" data-modal="notes-modal">NOTE'S <span id="note-count"></span></div>
                </div>
            </div>
        </aside>
    </div>

    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div id="password-modal-header" class="modal-header">ACCESS REQUIRED</div>
            <div id="login-form-content">
                <div class="modal-body">
                    <div class="form-group" style="justify-content: center;">
                        <label for="password-input" style="text-align: center; margin-right: 10px;">Enter Password:</label>
                        <input type="password" id="password-input" required>
                    </div>
                </div>
                <div class="modal-footer" style="justify-content: center;">
                    <button class="modal-close-btn" data-modal-id="password-modal">Cancel</button>
                    <button id="submitBtn">Submit</button>
                </div>
                <div class="change-password-link">Change Password?</div>
            </div>
            <div id="change-form-content" style="display: none;">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="old-password-input">Old Password:</label>
                        <input type="password" id="old-password-input" required>
                    </div>
                    <div class="form-group">
                        <label for="new-password-input">New Password:</label>
                        <input type="password" id="new-password-input" required>
                    </div>
                </div>
                <div class="modal-footer" style="justify-content: center;">
                    <button id="cancelChangeBtn">Cancel</button>
                    <button id="changePasswordBtn">Change Password</button>
                </div>
            </div>
        </div>
    </div>

    <div id="data-entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">DAILY DATA ENTRY (MANUAL)</div>
            <div class="modal-body">
                <form id="daily-data-form">
                    <div class="modal-sub-header">MACHINE TOTAL OUTPUT</div>
                    <div class="form-group">
                        <label for="manual-auto-crimp">Auto Crimp:</label>
                        <input type="number" id="manual-auto-crimp" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-semi-crimp">Semi Crimp:</label>
                        <input type="number" id="manual-semi-crimp" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-soldering">Soldering:</label>
                        <input type="number" id="manual-soldering" required>
                    </div>

                    <div class="modal-sub-header">CUT'S HOUR QTY (Shifts)</div>
                    <div class="form-group">
                        <label for="manual-shift-a">Shift A:</label>
                        <input type="number" id="manual-shift-a" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-shift-b">Shift B:</label>
                        <input type="number" id="manual-shift-b" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-shift-c">Shift C:</label>
                        <input type="number" id="manual-shift-c" required>
                    </div>

                    <div class="modal-sub-header">BREAKDOWN TIME (Current Day)</div>
                    <div class="form-group">
                        <label for="manual-msf-p2">MSF Plant 2:</label>
                        <input type="number" id="manual-msf-p2" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-msf-p7">MSF Plant 7:</label>
                        <input type="number" id="manual-msf-p7" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-assembly-p2">Assembly Plant 2:</label>
                        <input type="number" id="manual-assembly-p2" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-assembly-p7">Assembly Plant 7:</label>
                        <input type="number" id="manual-assembly-p7" required>
                    </div>

                    <div class="modal-sub-header">BREAKDOWN TIME (Monthly Total)</div>
                    <div class="form-group">
                        <label for="manual-msf-mtotal-p2">MSF MTotal P2:</label>
                        <input type="number" id="manual-msf-mtotal-p2" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-msf-mtotal-p7">MSF MTotal P7:</label>
                        <input type="number" id="manual-msf-mtotal-p7" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-assembly-mtotal-p2">Assembly MTotal P2:</label>
                        <input type="number" id="manual-assembly-mtotal-p2" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-assembly-mtotal-p7">Assembly MTotal P7:</label>
                        <input type="number" id="manual-assembly-mtotal-p7" required>
                    </div>

                    <div class="modal-sub-header">OTHER DATA</div>
                    <div class="form-group">
                        <label for="manual-productivity">Productivity (%):</label>
                        <input type="number" id="manual-productivity" min="0" max="100" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-lv-value">LV Value (₹):</label>
                        <input type="number" id="manual-lv-value" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="data-entry-modal">Cancel</button>
                <button id="updateDashboardBtn">Update Dashboard</button>
            </div>
        </div>
    </div>

    <div id="trend-update-choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">UPDATE PRODUCTION TREND</div>
            <div class="modal-body">
                <div class="form-group user-list">
                    <button class="control-btn" id="manual-trend-update-btn">MANUAL UPDATE</button>
                    <button class="control-btn" id="auto-trend-update-btn">AUTOMATIC UPDATE (JSON)</button>
                </div>
                <p style="margin-top: 15px; font-size: 0.8em; text-align: center;">Automatic update requires a JSON file.</p>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="trend-update-choice-modal">Cancel</button>
            </div>
        </div>
    </div>
    <div id="trend-entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">UPDATE PRODUCTION TREND DATA (MANUAL)</div>
            <div class="modal-body">
                <div class="modal-sub-header">SELECT CUSTOMER</div>
                <div class="form-group">
                    <label for="edit-customer-select">Customer:</label>
                    <select id="edit-customer-select">
                        <option value="">-- Select Customer --</option>
                    </select>
                </div>

                <div class="modal-sub-header">EDIT VALUES</div>
                <div class="form-group">
                    <label for="edit-output">Overall Output:</label>
                    <input type="number" id="edit-output">
                </div>
                <div class="form-group">
                    <label for="edit-percent">Percentage (%):</label>
                    <input type="number" id="edit-percent" min="0" max="100">
                </div>
            </div>
            <div class="modal-footer">
                <button id="removeTrendBtn" class="modal-close-btn" style="background-color: var(--error-color);">Remove Entry</button>
                <button class="modal-close-btn" data-modal-id="trend-entry-modal">Cancel</button>
                <button id="updateTrendBtn">Update Trend</button>
            </div>
        </div>
    </div>

    <div id="user-list-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">USER FOLDERS</div>
            <div class="modal-body">
                <div class="form-group user-list">
                    <button class="control-btn user-btn" data-user="kirushnaraj">KIRUSHNARAJ</button>
                    <button class="control-btn user-btn" data-user="siva">SIVA</button>
                    <button class="control-btn user-btn" data-user="praveen">PRAVEEN</button>
                    <button class="control-btn user-btn" data-user="sandhosh">SANDHOSH</button>
                    <button class="control-btn user-btn" data-user="sathya">SATHYA</button>
                    <button class="control-btn user-btn" data-user="raghu">RAGHU</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="user-list-modal">Close</button>
            </div>
        </div>
    </div>

    <div id="notes-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">NOTES <span id="notes-count-header"></span></div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="text" id="note-input" placeholder="Enter a new note..." style="width: 100%; text-align: left;">
                </div>
                <div class="modal-footer" style="justify-content: center;">
                    <button id="addNoteBtn" class="control-btn">Add Note</button>
                </div>
                <div id="notes-list" style="margin-top: 20px;"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="notes-modal">Close</button>
            </div>
        </div>
    </div>
    
    <div id="update-choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">UPDATE DASHBOARD</div>
            <div class="modal-body">
                <div class="form-group user-list">
                    <button class="control-btn" id="manual-update-btn">MANUAL UPDATE</button>
                    <button class="control-btn" id="auto-update-btn">AUTOMATIC UPDATE (EXCEL/JSON)</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="update-choice-modal">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>