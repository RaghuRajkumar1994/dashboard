<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Team Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <div class="dashboard-container">
        
        <header class="dashboard-header">
            <div class="header-logo">
                <select id="theme-selector" class="theme-selector">
                    <option value="default">Default Theme</option>
                    <option value="green">Green Theme</option>
                    <option value="blue">Blue Theme</option>
                    <option value="purple">Purple Theme</option>
                    <option value="red">Red Theme</option>
                    <option value="orange">Orange Theme</option>
                    <option value="cyan">Cyan Theme</option>
                    <option value="mono">Monochrome</option>
                </select>
                <input type="month" id="month-selector" class="header-date">
            </div>
            <h1 class="header-title">PRODUCTION TEAM DASHBOARD</h1>
            <div class="header-controls">
                <button class="control-btn" id="open-update-btn">UPDATE</button>
                <input type="file" id="excelFileInput" accept=".xlsx, .xls, .json" style="display: none;">
                <input type="file" id="trendFileInput" accept=".json" style="display: none;"> 
            </div>
        </header>

        <main class="dashboard-main">
            <section class="top-row-panels">
                <div class="panel machine-output">
                    <div class="panel-header">MACHINE TOTAL OUTPUT</div>
                    <div class="output-list">
                        <div class="output-item auto-crimp"><span>AUTO CRIMP</span><span id="auto-crimp-output"></span></div>
                        <div class="output-item semi-crimp"><span>SEMI CRIMP</span><span id="semi-crimp-output"></span></div>
                        <div class="output-item soldering"><span>SOLDERING</span><span id="soldering-output"></span></div>
                    </div>
                </div>
                
                <div class="panel cut-qty">
                    <div class="panel-header">CUT'S HOUR QTY</div>
                    <div class="cut-qty-grid">
                        <div class="shifts-container">
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-A</div><div class="shift-value" id="shift-a-value"></div>
                            </div>
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-B</div><div class="shift-value" id="shift-b-value"></div>
                            </div>
                            <div class="shift-item">
                                <div class="shift-label">SHIFT-C</div><div class="shift-value" id="shift-c-value"></div>
                            </div>
                        </div>
                        <div class="average-box">
                            <span class="average-label">AVERAGE</span><span class="average-value" id="cuts-average-value"></span>
                        </div>
                    </div>
                </div>

                <div class="panel breakdown-time">
                    <div class="panel-header">BREAKDOWN TIME</div>
                    <div class="breakdown-grid-container">
                        <div class="breakdown-section msf-section">
                            <div class="col-label">MSF</div>
                            <div class="breakdown-data-item"><span>PLANT-2</span><span class="data-value" id="msf-plant-2"></span></div>
                            <div class="breakdown-data-item"><span>PLANT-7</span><span class="data-value" id="msf-plant-7"></span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P2</span><span class="data-value" id="m-total-msf-p2"></span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P7</span><span class="data-value" id="m-total-msf-p7"></span></div>
                        </div>
                        <div class="breakdown-section assembly-section">
                            <div class="col-label">ASSEMBLY</div>
                            <div class="breakdown-data-item"><span>PLANT-2</span><span class="data-value" id="assembly-plant-2"></span></div>
                            <div class="breakdown-data-item"><span>PLANT-7</span><span class="data-value" id="assembly-plant-7"></span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P2</span><span class="data-value" id="m-total-assembly-p2"></span></div>
                            <div class="breakdown-data-item"><span>M-TOTAL P7</span><span class="data-value" id="m-total-assembly-p7"></span></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="panel production-trend-panel">
                <div class="panel-header">PRODUCTION TREND <button class="update-trend-btn" id="open-trend-update-btn">UPDATE TREND</button></div>
                <div class="table-container">
                    <table id="production-trend-table">
                        <thead>
                            <tr>
                                <th class="trend-header-cell">CUSTOMER NAME</th>
                                <th class="trend-header-cell">OVERALL OUTPUT</th>
                                <th class="trend-header-cell">%</th>
                                <th class="trend-header-cell">CUSTOMER NAME</th>
                                <th class="trend-header-cell">OVERALL OUTPUT</th>
                                <th class="trend-header-cell">%</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>
        </main>

        <aside class="sidebar">
            <div class="panel shortcut-panel">
                <div class="panel-header">DATA EXCEL SHORTCUT</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\BreakdownSheet.xlsx">BREAKDOWN SHEET</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\Plant2Data.xlsx">PLANT 2</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\Plant7Data.xlsx">PLANT 7</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\CutsHourQty.xlsx">CUT'S HOUR QTY</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\DRM.xlsx">DRM</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\ProductionAct.xlsx">PRODUCTION ACT</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\SFTProductionReport.xlsx">SFT PRODUCTION REPORT</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\StockLiveData.xlsx">STOCK LIVE DATA</div>
                <div class="shortcut-item" data-link="\\\\192.168.4.6\\CCS Lab\\raghu\\MSFPrintoutSheets.xlsx">MSF PRINTOUT SHEETS</div>
            </div>
            
            <div class="panel productivity-panel">
                <div class="panel-header">PRODUCTIVITY</div>
                <div class="chart-container">
                    <div class="chart-circle productivity-chart" style="background: conic-gradient(#50fa7b 75%, transparent 0);">
                        <span class="chart-value" id="productivity-value"></span>
                    </div>
                </div>
            </div>
            
            <div class="panel schedule-panel">
                <div class="panel-header">SCHEDULE AVERAGE</div>
                <div class="chart-container">
                    <div class="chart-circle schedule-chart" style="background: conic-gradient(#ff79c6 56%, transparent 0);">
                        <span class="chart-value" id="schedule-value"></span>
                    </div>
                </div>
            </div>

            <div class="panel lv-production-panel">
                <div class="panel-header">LV-PRODUCTION VALUE</div>
                <div class="value-box">â‚¹ <span id="lv-production-value"></span></div>
            </div>
            
            <div class="panel mail-panel">
                <button class="control-btn" id="openMail">OPEN MAIL</button>
            </div>
            
            <div class="panel user-panel">
                <div class="panel-header">USER LOGIN</div>
                <div class="user-list">
                    <button class="user-btn control-btn" data-user="ADMIN">ADMIN</button>
                    <button class="user-btn control-btn" data-user="OPERATOR">OPERATOR</button>
                </div>
                <div class="panel-header"><span data-modal="notes-modal" style="cursor: pointer;">NOTES <span id="note-count"></span></span></div>
            </div>
        </aside>

    </div>

    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">AUTHENTICATION REQUIRED FOR <span id="auth-action-display"></span></div>
            <div class="modal-body" id="login-form">
                <div class="form-group">
                    <label for="password-input">Password:</label>
                    <input type="password" id="password-input" class="modal-input" required>
                </div>
                <div class="modal-footer" style="justify-content: space-between;">
                    <span class="change-password-link">Change Password?</span>
                    <button id="submitBtn" class="control-btn">Submit</button>
                </div>
            </div>
            <div class="modal-body" id="change-password-form" style="display: none;">
                <div class="form-group">
                    <label for="current-password-input">Current Password:</label>
                    <input type="password" id="current-password-input" class="modal-input" required>
                </div>
                <div class="form-group">
                    <label for="new-password-input">New Password:</label>
                    <input type="password" id="new-password-input" class="modal-input" required>
                </div>
                <div class="form-group">
                    <label for="confirm-password-input">Confirm New Password:</label>
                    <input type="password" id="confirm-password-input" class="modal-input" required>
                </div>
                <div class="modal-footer" style="justify-content: flex-end; gap: 10px;">
                    <button id="cancelChangeBtn" class="control-btn" style="background-color: var(--warning-color);">Cancel</button>
                    <button id="changePasswordBtn" class="control-btn">Change</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="notes-modal" class="modal" data-modal="notes-modal">
        <div class="modal-content">
            <div class="modal-header">NOTES <span id="notes-count-header"></span></div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="text" id="note-input" placeholder="Enter a new note..." style="width: 100%; text-align: left;">
                </div>
                <div class="modal-footer" style="justify-content: center;">
                    <button id="addNoteBtn" class="control-btn">Add Note</button>
                </div>
                <div id="notes-list" style="margin-top: 20px;"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="notes-modal">Close</button>
            </div>
        </div>
    </div>
    
    <div id="update-choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">UPDATE DASHBOARD</div>
            <div class="modal-body">
                <div class="form-group user-list">
                    <button class="control-btn" id="manual-update-btn">MANUAL UPDATE</button>
                    <button class="control-btn" id="auto-update-btn">AUTOMATIC UPDATE (EXCEL/JSON)</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="update-choice-modal">Cancel</button>
            </div>
        </div>
    </div>
    
    <div id="trend-update-choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">UPDATE PRODUCTION TREND</div>
            <div class="modal-body">
                <div class="form-group user-list">
                    <button class="control-btn" id="manual-trend-update-btn">MANUAL UPDATE</button>
                    <button class="control-btn" id="auto-trend-update-btn">AUTOMATIC UPDATE (JSON)</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn" data-modal-id="trend-update-choice-modal">Cancel</button>
            </div>
        </div>
    </div>

    <div id="data-entry-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">MANUAL DATA ENTRY - <span id="current-month-display"></span></div>
            <div class="modal-body">
                <form id="daily-data-form" class="data-entry-grid">
                    <div class="form-group">
                        <label>Auto Crimp Output:</label>
                        <input type="number" name="autoCrimpOutput" id="autoCrimpOutput" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Semi Crimp Output:</label>
                        <input type="number" name="semiCrimpOutput" id="semiCrimpOutput" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Soldering Output:</label>
                        <input type="number" name="solderingOutput" id="solderingOutput" class="modal-input" placeholder="0">
                    </div>
                    
                    <div class="form-group grid-full-row"><h3>CUT'S HOUR QTY</h3></div>

                    <div class="form-group">
                        <label>Shift A Value:</label>
                        <input type="number" name="shiftAValue" id="shiftAValue" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Shift B Value:</label>
                        <input type="number" name="shiftBValue" id="shiftBValue" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Shift C Value:</label>
                        <input type="number" name="shiftCValue" id="shiftCValue" class="modal-input" placeholder="0">
                    </div>
                    
                    <div class="form-group grid-full-row"><h3>BREAKDOWN TIME</h3></div>

                    <div class="form-group">
                        <label>MSF Plant 2 (Day):</label>
                        <input type="number" step="0.01" name="msfP2" id="msfP2" class="modal-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>MSF Plant 7 (Day):</label>
                        <input type="number" step="0.01" name="msfP7" id="msfP7" class="modal-input" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Assembly Plant 2 (Day):</label>
                        <input type="number" name="assemblyP2" id="assemblyP2" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Assembly Plant 7 (Day):</label>
                        <input type="number" name="assemblyP7" id="assemblyP7" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>MSF M-Total P2:</label>
                        <input type="number" name="mTotalMsfP2" id="mTotalMsfP2" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>MSF M-Total P7:</label>
                        <input type="number" name="mTotalMsfP7" id="mTotalMsfP7" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Assembly M-Total P2:</label>
                        <input type="number" name="mTotalAssemblyP2" id="mTotalAssemblyP2" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Assembly M-Total P7:</label>
                        <input type="number" name="mTotalAssemblyP7" id="mTotalAssemblyP7" class="modal-input" placeholder="0">
                    </div>
                    
                    <div class="form-group grid-full-row"><h3>OTHER METRICS</h3></div>
                    
                    <div class="form-group">
                        <label>Productivity (%):</label>
                        <input type="number" name="productivityValue" id="productivityValue" class="modal-input" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>LV Production Value (â‚¹):</label>
                        <input type="number" name="lvProductionValue" id="lvProductionValue" class="modal-input" placeholder="0">
                    </div>
                </form>
            </div>
            <div class="modal-footer" style="justify-content: space-between;">
                <button class="modal-close-btn" data-modal-id="data-entry-modal">Cancel</button>
                <button id="updateDashboardBtn" class="control-btn">Update Dashboard</button>
            </div>
        </div>
    </div>

    <div id="trend-entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">MANUAL TREND UPDATE</div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-customer-input">Customer Name (Select Existing or Enter New):</label>
                    <input list="customer-list" id="edit-customer-input" class="modal-input" placeholder="Enter or select customer name">
                    <datalist id="customer-list"></datalist>
                </div>
                <div class="form-group">
                    <label for="edit-output">Overall Output:</label>
                    <input type="number" id="edit-output" class="modal-input" placeholder="0">
                </div>
                <div class="form-group">
                    <label for="edit-percent">Percentage (%):</label>
                    <input type="number" id="edit-percent" class="modal-input" placeholder="0">
                </div>
                <div class="modal-footer" style="justify-content: space-between; margin-top: 20px;">
                    <button id="removeTrendBtn" class="control-btn" style="background-color: var(--error-color);">Remove Customer</button>
                    <div>
                        <button class="modal-close-btn control-btn" data-modal-id="trend-entry-modal" style="background-color: var(--warning-color);">Cancel</button>
                        <button id="updateTrendBtn" class="control-btn">Save Update</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>